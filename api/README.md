# SeeShells API

The SeeShells API facilitates optional configuration for the desktop application. With the ability to obtain updated configuration files and a new help file as they become available from the website. 

## Overview
SeeShells uses Node.Js / Express.JS for serving the API and a Postgres database for storing all information related to the website and application.

![image](https://user-images.githubusercontent.com/17878901/79650682-29c7a180-817f-11ea-866d-f7e3119d3660.png)

## Database Setup

### Required Software
- A [PostgreSQL Database](https://www.npmjs.com/get-npm)

### Instructions
1. [Install Postgres](https://www.postgresqltutorial.com/install-postgresql/) and make it listenable 
2. Create the SeeShells API tables with the following SQL queries:

| Purpose                           | SQL Command                                                                                                                                                                                                                                                                      |
|-----------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Create the main shell keys table. | create table mainshellkeys ( mainkeysid serial not null constraint mainshellkeys_pkey primary key );                                                                                                                                                                             |
| Create the OS versions table.     | create table osversion( osid serial not null constraint osversion_pkey primary key, osnum varchar(255) not null constraint osversion_osnum_key unique, osname varchar(255) not null, mainkeysid integer not null constraint osversion_mainkeysid_fkey references mainshellkeys); |
| Create the various keys table.    | create table keys( keyid serial not null constraint keys_pkey primary key, location varchar(255) not null, mainkeysid integer not null constraint keys_mainkeysid_fkey references mainshellkeys);                                                                                |
| Create the GUID table.            | create table guids( id serial not null constraint guids_pkey primary key, guid varchar(255) not null constraint guids_guid_key unique, name varchar(255) not null);                                                                                                              |
| Create the login table.           | create table logininfo( id serial not null constraint logininfo_pkey primary key, username varchar(255) not null constraint logininfo_username_key unique, password text not null, salt text not null, approved boolean);                                                        |
| Create the Session Table          | create table session( sid varchar not null constraint session_pkey primary key, sess json not null, expire timestamp(6) not null); create index "IDX_session_expire" on session (expire);                                                                                        |
| Create the scripts table          | create table scripts( id serial not null constraint scripts_pkey primary key, typeidentifier integer, script text not null);                                                                                                                                                     |
| Create the help table             | create table helpinfo( id serial not null constraint helpinfo_pkey primary key, title text, description text);                                                                                                                                                                   |

## API Setup

### Required Software
- [Node.JS](https://www.npmjs.com/get-npm)

### Instructions
1. set the three environment variables `DATABASE_URL`,`SESSION_SECRET`, and `PORT`
   - Examples:
   ```
   DATABASE_URL = postgresql://postgres:postgres@localhost:5432/postgres
   SESSION_SECRET = seeshell
   PORT = 3000
   ```
2. run `npm install` in SeeShells API directory
3. run `npm start`
   - _**Note:** SeeShells by default will only connect to a PostgreSQL database via an SSL connection. If you are not able to use SSL you must change the code to disable SSL enforcement._
You can now make requests 
4. Change the Access-Control-Allow-Origin policy to support a different hostname located in [index.js](https://github.com/RickLeinecker/SeeShells/blob/master/api/index.js)
    - _(Example: set the policy to `*` to allow API requests to come from any location.)\
      `res.setHeader('Access-Control-Allow-Origin', '*');`_

You should now be able to receive information from the API by visiting the configured URL (e.g. http://localhost:3000)

## API Specification

### _Register API_

This endpoint is needed to register administrators on the SeeShells website and is located at &quot;/register&quot; at the end of the SeeShells website URL. It is a POST request since it will be creating an account in the database. In the process of sending the request, the server checks the database to see if the username already exists. If the username does not exist, then the registration continues in the server; if the username does exist, the server returns an error. Before the password is saved into the database, the password will be hashed and salted server-side.

| Request                                                                       |                                                                |                                        |
|-------------------------------------------------------------------------------|----------------------------------------------------------------|----------------------------------------|
| Parameter                                                                     | Mandatory                                                      | Description                            |
| username                                                                      | Yes                                                            | Username to be registered\.            |
| password                                                                      | Yes                                                            | Plaintext password for registration\.  |
| Example request: \{“username”:“admin”, “password”:“pass123”\}                 |
|                                                                               |
| Response                                                                      |                                                                |
| Parameter                                                                     | Description                                                    |
| success                                                                       | 1 if successful, 0 if not                                      |
| error                                                                         | If failed, this will contain a message describing the error\.  |
| Example of successful response: \{“success”:1\}                               |
| Example of failed response: \{“success”:0, “error”: “User already exists\.”\} |

### _Login API_

This endpoint is needed to allow administrators to log into their accounts on the SeeShells website and is located at &quot;/login&quot; at the end of the SeeShells website URL. It is a POST request since it will be providing data on a resource and creating a session in the database. When this request is processed, the server first checks if the user exists in the database. If the user does not exist, the server returns an error; if the user does exist, the server gets the salt value used for the user&#39;s password. The server then hashes and salts the provided password in the request and compares it to the password stored in the database. If the passwords match, a session is created for the user and they are logged in. If the passwords do not match, the server returns an error.

| Request                                                                                            |                                                                                                      |                                      |
|----------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|--------------------------------------|
| Parameter                                                                                          | Mandatory                                                                                            | Description                          |
| username                                                                                           | Yes                                                                                                  | Username to log in with\.            |
| password                                                                                           | Yes                                                                                                  | Plaintext password to log in with\.  |
| Example request: \{“username”:“admin”, “password”:“pass123”\}                                      |
|                                                                                                    |
| Response                                                                                           |                                                                                                      |
| Parameter                                                                                          | Description                                                                                          |
| success                                                                                            | 1 if successful, 0 if not                                                                            |
| error                                                                                              | If failed, this will contain a message describing the error\.                                        |
| session                                                                                            | If successful, this field contains a JSON session item; this is used to authorize other endpoints\.  |
| Example of successful response: \{“ success":1, "sessionID":"rGIxucrETI20XgQgpqgcdJElXZaMUedO" \}  |
| Example of failed response: \{“ success":0, "error": "User does not exist" \}                      |

### _Active Session API_

This GET endpoint is needed to make sure the user is logged in and has an active session when attempting to modify anything on the administrative portion of the website. It is located at &quot;/SessionIsActive&quot; at the end of the SeeShells website URL. The session is sent in the &quot;x-auth-token&quot; header in the request to this endpoint. If the session exists and is active, a JSON response is sent as {success: 1}; otherwise, the user is redirected to a &quot;Not Authenticated&quot; response.

### _Get New Users API_

This endpoint is needed to retrieve the list of users that are attempting to register as an administrator. This endpoint is used on the website to allow current administrators to then approve or reject these new users..

| Response                                                                                    |                                                                               |
|---------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|
| Parameter                                                                                   | Description                                                                   |
| success                                                                                     | 1 if successful, 0 if not                                                     |
| error                                                                                       | If failed, this will contain a message describing the error\.                 |
| json                                                                                        | A list of users that have registered but have not been approved or rejected\. |
| Example of successful response: \{"success":1,"json":\[\{"id":42,"username":"newUser"\}\]\} |
| Example of failed response:  \{“success”:0, “error”: “Failed to get any existing users\.”\} |

### _Approve User API_

This endpoint is needed to approve any new administrators that attempt to register on the website. Using this endpoint requires a valid session to be active and sent in the header of the request. It is located at &quot;/approveUser&quot; at the end of the SeeShells website URL.

| Request                                                                                |                                                                |                                                   |
|----------------------------------------------------------------------------------------|----------------------------------------------------------------|---------------------------------------------------|
| Parameter                                                                              | Mandatory                                                      | Description                                       |
| userID                                                                                 | Yes                                                            | The user ID of the user that is to be approved\.  |
| Example request: \{“userID”:42\}                                                       |                                                                |                                                   |
|                                                                                        |                                                                |                                                   |
| Response                                                                               |                                                                |                                                   |
| Parameter                                                                              | Description                                                    |                                                   |
| success                                                                                | 1 if successful, 0 if not                                      |                                                   |
| error                                                                                  | If failed, this will contain a message describing the error\.  |                                                   |
| Example of successful response: \{“success":1\}                                        |                                                                |                                                   |
| Example of failed response: \{“success":0, "error": "Failed to approve the user\." \}  |                                                                |                                                   |

### _Reject User API_

This endpoint is needed to reject any new administrators that attempt to register on the website; using it will remove the login information from the users table. Using this endpoint requires a valid session to be active and sent in the header of the request. It is located at &quot;/rejectUser&quot; at the end of the SeeShells website URL.

| Request                                                                               |                                                                |                                                   |
|---------------------------------------------------------------------------------------|----------------------------------------------------------------|---------------------------------------------------|
| Parameter                                                                             | Mandatory                                                      | Description                                       |
| userID                                                                                | Yes                                                            | The user ID of the user that is to be rejected\.  |
| Example request: \{“userID”:42\}                                                      |                                                                |                                                   |
|                                                                                       |                                                                |                                                   |
| Response                                                                              |                                                                |                                                   |
| Parameter                                                                             | Description                                                    |                                                   |
| success                                                                               | 1 if successful, 0 if not                                      |                                                   |
| error                                                                                 | If failed, this will contain a message describing the error\.  |                                                   |
| Example of successful response: \{“success":1\}                                       |                                                                |                                                   |
| Example of failed response: \{“success":0, "error": "Failed to delete the user\." \}  |                                                                |                                                   |

### _Get OS and Associated File Location API_

This endpoint is needed to get the data for one of the configuration files that the WPF uses and is located at &quot;/getOSandRegistryLocations&quot; at the end of the SeeShells website URL. It is a GET request since it will be retrieving data without modifying it. The request does not need any parameters sent to it, and the expected response is shown below

| Response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|
| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Description                                                    |
| success                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 1 if successful, 0 if not                                      |
| error                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | If failed, this will contain a message describing the error\.  |
| json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | The contents of the configuration file                         |
| Example of successful response: \{"success":1,"json":\[\{"os":"Windows XP","files":\["NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\Shell\\\\BagMRU","NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\Shell\\\\Bags","NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\ShellNoRoam\\\\BagMRU","NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\ShellNoRoam\\\\Bags"\]\},\{"os":"Windows XP 64\-Bit","files":\["NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\Shell\\\\BagMRU","NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\Shell\\\\Bags","NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\ShellNoRoam\\\\BagMRU","NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\ShellNoRoam\\\\Bags”\}\]\} |                                                                |
| JSON is cut short due to length\. See the following Figure 48 for another example\.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                |
| Example of failed response:  \{“success”:0, “error”: “No files to fetch”\}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                |

### _Get GUIDs API_

This endpoint is needed to get the data for one of the configuration files that the WPF uses and is located at &quot;/getGUIDs&quot; at the end of the SeeShells website URL. This data is queried from the database instead of hardcoded in the program since new GUIDs can be discovered and added over time. This endpoint is a GET request since it will be retrieving data without modifying it.:

| Response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                     |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Description                                                         |
| success                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 1 if successful, 0 if not                                           |
| error                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | If failed, this will contain a message describing the error\.       |
| json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | The contents of the configuration file containing a list of GUIDs\. |
| Example of successful response: \{"success":1,"json":\[\{"guid":"008ca0b1\-55b4\-4c56\-b8a8\-4de4b299d3bE","name":"Account Pictures"\},\{"guid":"00bcfc5a\-ed94\-4e48\-96a1\-3f6217f21990","name":"RoamingTiles"\},\{"guid":"00c6d95f\-329c\-409a\-81d7\-c46c66ea7f33","name":"Default Location"\},\{"guid":"00f2886f\-cd64\-4fc9\-8ec5\-30ef6cdbe8c3","name":"Scanners and Cameras"\},\{"guid":"0139d44e\-6afe\-49f2\-8690\-3dafcae6ffb8","name":"Programs"\},\{"guid":"0142e4d0\-fb7a\-11dc\-ba4a\-000ffe7ab428","name":"Biometric Devices"\},\{"guid":"018d5c66\-4533\-4307\-9b53\-224de2ed1fe6","name":"OneDrive"\},\{"guid":"025a5937\-a6be\-4686\-a844\-36fe4bec8b6d","name":"Power Options"\},\{"guid":"031e4825\-7b94\-4dc3\-b131\-e946b44c8dd5","name":"Libraries"\}\]\} |                                                                     |
| Example of failed response: \{“success”:0, “error”: ”Failed to get any GUIDs”\}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                     |

### _Add GUID API_

This endpoint is needed to add new or update any GUID identifiers and is located at &quot;/addGUID&quot; at the end of the SeeShells website URL. It is a POST request since it will be creating a new record. Using this endpoint requires a valid session to be active and sent in the header of the request. Before adding the GUID to the database, the server checks if it already exists since it is important that these identifiers are unique. If the GUID does already exist, that GUID is updated instead of duplicated; if the GUID does not exist, then it is added to the database.

| Request                                                                                              |                                                                |                                                                       |
|------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|-----------------------------------------------------------------------|
| Parameter                                                                                            | Mandatory                                                      | Description                                                           |
| GUID                                                                                                 | Yes                                                            | This is the GUID value\.                                              |
| Name                                                                                                 | Yes                                                            | This is the human\-readable and understandable meaning of the GUID\.  |
| Example request: \{“GUID”: “008ca0b1\-55b4\-4c56\-b8a8\-4de4b299d3bE”, “Name”: “Account Pictures”\}  |                                                                |                                                                       |
|                                                                                                      |                                                                |                                                                       |
| Response                                                                                             |                                                                |                                                                       |
| Parameter                                                                                            | Description                                                    |                                                                       |
| success                                                                                              | 1 if successful, 0 if not                                      |                                                                       |
| error                                                                                                | If failed, this will contain a message describing the error\.  |                                                                       |
| Example of successful response: \{“success”:1\}                                                      |                                                                |                                                                       |
| Example of failed response: \{“success”: 0, “error”: “Failed to update GUID\.”                       |                                                                |                                                                       |

### _Delete GUID API_

This endpoint is needed to delete any GUIDs. This may come in handy if an administrator realizes they made a typo and need to remove an entry. Using this endpoint requires a valid session to be active and sent in the header of the request. It is a POST request and is located at &quot;/deleteGUID&quot; at the end of the SeeShells website URL.

| Request                                                                        |                                                                |                                                           |
|--------------------------------------------------------------------------------|----------------------------------------------------------------|-----------------------------------------------------------|
| Parameter                                                                      | Mandatory                                                      | Description                                               |
| id                                                                             | Yes                                                            | This is the ID of the GUID entry that is to be deleted\.  |
| Example request: \{“id”: 50\}                                                  |                                                                |                                                           |
|                                                                                |                                                                |                                                           |
| Response                                                                       |                                                                |                                                           |
| Parameter                                                                      | Description                                                    |                                                           |
| success                                                                        | 1 if successful, 0 if not                                      |                                                           |
| error                                                                          | If failed, this will contain a message describing the error\.  |                                                           |
| Example of successful response: \{“success”:1\}                                |                                                                |                                                           |
| Example of failed response: \{“success”: 0, “error”: “Failed to delete GUID\.” |                                                                |                                                           |

### _Add OS API_

This endpoint is needed to add new versions of Windows when they come out. This endpoint can only be used for Windows versions that use the same key locations as a previous OS version; if a new OS uses new registry key locations, then the other &quot;Add OS with File Locations&quot; API endpoint must be used. Using this endpoint requires a valid session to be active and sent in the header of the request. This endpoint is located at &quot;/addOS&quot; at the end of the SeeShells website URL. The data added by this endpoint will be used in the configuration file for the WPF. It is a POST request since it will be adding data to the database. A list of possible key ids that can be used for this endpoint can be obtained from the &quot;Get Registry Locations&quot; API endpoint. The server may return an error if the OS version already exists in the database, if the keys ID selected does not exist, or if there are any issues with connecting to the database.

| Request                                                                                              |                                                                |                                                                                                                                           |
|------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| Parameter                                                                                            | Mandatory                                                      | Description                                                                                                                               |
| osnum                                                                                                | Yes                                                            | The version number of the Windows OS\.                                                                                                    |
| osname                                                                                               | Yes                                                            | The product name of the Windows OS version\.                                                                                              |
| mainkeysid                                                                                           | Yes                                                            | If the new OS version has the same parsing information for Shellbags as a previous version, that key locations ID can be specified here\. |
| Example request: \{“osnum”:“11\.0”, “osname”:“Windows 11 Pro”, “mainkeysid”:1\}                      |                                                                |                                                                                                                                           |
|                                                                                                      |                                                                |                                                                                                                                           |
| Response                                                                                             |                                                                |                                                                                                                                           |
| Parameter                                                                                            | Description                                                    |                                                                                                                                           |
| success                                                                                              | 1 if successful, 0 if not                                      |                                                                                                                                           |
| error                                                                                                | If failed, this will contain a message describing the error\.  |                                                                                                                                           |
| Example of successful response: \{“success”:1\}                                                      |                                                                |                                                                                                                                           |
| Example of successful response: \{ "success": 0, "error": "The keys ID selected does not exist\." \} |                                                                |                                                                                                                                           |

### _Add OS With File Locations API_

This endpoint is needed to add new versions of Windows when they come out with new registry key locations; the endpoint is located at &quot;/addOSWithFileLocations&quot; at the end of the SeeShells website URL. Using this endpoint requires a valid session to be active and sent in the header of the request. This data added by this endpoint will be used in one of the configuration files for the WPF application. It is a POST request since it will be adding data to the database. A new OS entry is created in the OS table, and a new grouping of keys is created in the key group table with the new locations being added in the keys table. Errors can be returned from the server if the new OS is already in the database.

| Request                                                                                                                                |                                                                |                                                                                              |
|----------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|----------------------------------------------------------------------------------------------|
| Parameter                                                                                                                              | Mandatory                                                      | Description                                                                                  |
| osnum                                                                                                                                  | Yes                                                            | The version number of the Windows OS\.                                                       |
| osname                                                                                                                                 | Yes                                                            | The product name of the Windows OS version\.                                                 |
| keys                                                                                                                                   | Yes                                                            | This is an array of file locations where ShellBag data can be found in the new OS version\.  |
| Example request: \{"osnum":"11\.2", "osname": "Windows 11 Updated", "keys":\["test\\\\location\\\\blah", "test\\\\location\\\\number\\ | wo"\]\}                                                        |                                                                                              |   |
|                                                                                                                                        |                                                                |                                                                                              |
| Response                                                                                                                               |                                                                |                                                                                              |
| Parameter                                                                                                                              | Description                                                    |                                                                                              |
| success                                                                                                                                | 1 if successful, 0 if not                                      |                                                                                              |
| error                                                                                                                                  | If failed, this will contain a message describing the error\.  |                                                                                              |
| Example of successful response: \{“success”:1\}                                                                                        |                                                                |                                                                                              |
| Example of successful response: \{“success”:0, “error”: “Failed to add the new registry key locations”\}                               |                                                                |                                                                                              |

### _Delete OS API_

This endpoint is needed to delete any Windows Operating Systems versions that were added to the database. This may come in handy if an administrator messed up while adding one and wants to start fresh. Using this endpoint requires a valid session to be active and sent in the header of the request. It is a POST request and is located at &quot;/deleteOS&quot; at the end of the SeeShells website URL.

| Request                                                                                |                                                                |                                                                      |
|----------------------------------------------------------------------------------------|----------------------------------------------------------------|----------------------------------------------------------------------|
| Parameter                                                                              | Mandatory                                                      | Description                                                          |
| osname                                                                                 | Yes                                                            | The product name of the Windows OS version\.                         |
| mainkeysid                                                                             | Yes                                                            | This is the ID of the main keys group that the OS version links to\. |
| Example request: \{"osname": "Windows 10", "mainkeysid":3\}                            |                                                                |                                                                      |
|                                                                                        |                                                                |                                                                      |
| Response                                                                               |                                                                |                                                                      |
| Parameter                                                                              | Description                                                    |                                                                      |
| success                                                                                | 1 if successful, 0 if not                                      |                                                                      |
| error                                                                                  | If failed, this will contain a message describing the error\.  |                                                                      |
| Example of successful response: \{“success”:1\}                                        |                                                                |                                                                      |
| Example of successful response: \{“success”:0, “error”: "Failed to delete the OS\."\}  |                                                                |                                                                      |

### _Add Key API_

This endpoint is needed to add new key locations to any Windows Operating Systems version. Using this endpoint requires a valid session to be active and sent in the header of the request. It is a POST request and is located at &quot;/addKey&quot; at the end of the SeeShells website URL. This endpoint internally handles the grouping of keys by creating a new group and duplicating keys if the OS version previously linked to a group shared by other OS versions. The expected request and response are shown in Figure 55.

| Request                                                                                                                                       |                                                                |                                                                      |
|-----------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|----------------------------------------------------------------------|
| Parameter                                                                                                                                     | Mandatory                                                      | Description                                                          |
| osname                                                                                                                                        | Yes                                                            | The product name of the Windows OS version\.                         |
| mainkeysid                                                                                                                                    | Yes                                                            | This is the ID of the main keys group that the OS version links to\. |
| location                                                                                                                                      | Yes                                                            | The location name of the key that is to be added\.                   |
| Example request: \{"osname": "Windows 10", "mainkeysid":3, “location”: “NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\Shell\\\\BagMRU”\} |                                                                |                                                                      |
|                                                                                                                                               |                                                                |                                                                      |
| Response                                                                                                                                      |                                                                |                                                                      |
| Parameter                                                                                                                                     | Description                                                    |                                                                      |
| success                                                                                                                                       | 1 if successful, 0 if not                                      |                                                                      |
| error                                                                                                                                         | If failed, this will contain a message describing the error\.  |                                                                      |
| Example of successful response: \{“success”:1\}                                                                                               |                                                                |                                                                      |
| Example of successful response: \{“success”:0, “error”: "Failed to add the key\." \}                                                          |                                                                |                                                                      |

### _Delete Key API_

This endpoint is needed to delete keys from any Windows Operating Systems version. Using this endpoint requires a valid session to be active and sent in the header of the request. It is a POST request and is located at &quot;/deleteOS&quot; at the end of the SeeShells website URL. This endpoint internally handles the grouping of keys by creating a new group and duplicating keys if the OS version previously linked to a group shared by other OS versions.

| Request                                                                                                                                       |                                                                |                                                                      |
|-----------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|----------------------------------------------------------------------|
| Parameter                                                                                                                                     | Mandatory                                                      | Description                                                          |
| osname                                                                                                                                        | Yes                                                            | The product name of the Windows OS version\.                         |
| mainkeysid                                                                                                                                    | Yes                                                            | This is the ID of the main keys group that the OS version links to\. |
| location                                                                                                                                      | Yes                                                            | The location name of the key that is to be deleted\.                 |
| Example request: \{"osname": "Windows 10", "mainkeysid":3, “location”: “NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\Shell\\\\BagMRU”\} |                                                                |                                                                      |
|                                                                                                                                               |                                                                |                                                                      |
| Response                                                                                                                                      |                                                                |                                                                      |
| Parameter                                                                                                                                     | Description                                                    |                                                                      |
| success                                                                                                                                       | 1 if successful, 0 if not                                      |                                                                      |
| error                                                                                                                                         | If failed, this will contain a message describing the error\.  |                                                                      |
| Example of successful response: \{“success”:1\}                                                                                               |                                                                |                                                                      |
| Example of successful response: \{“success”:0, “error”: "Failed to delete the key\." \}                                                       |                                                                |                                                                      |

### _Get Registry Locations API_

This endpoint is needed to get a list of what ShellBags files are in each key grouping in the database; using this endpoint can get you the key IDs needed for using the &quot;Add OS&quot; API endpoint. It is located at &quot;/getRegistryLocations&quot; at the end of the SeeShells website URL. It is a GET request since this endpoint will be fetching the data in the database without altering it.

| Response                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                         |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|
| Parameter                                                                                                                                                                                                                                                                                                                                                                                                       | Description                                                             |
| success                                                                                                                                                                                                                                                                                                                                                                                                         | 1 if successful, 0 if not                                               |
| error                                                                                                                                                                                                                                                                                                                                                                                                           | If failed, this will contain a message describing the error\.           |
| json                                                                                                                                                                                                                                                                                                                                                                                                            | An array of the key groupings with the files that belong to the group\. |
| Example of successful response: \{"success":1,"json":\[\{"mainkeysid":1,"keys":\["NTUSER\.DAT                                                                                                                                                                                                                                                                                                                   |                                                                         |
| \\\\Software\\\\Microsoft\\\\Windows\\\\Shell\\\\BagMRU","NTUSER\.DAT\\\\Software\\\\Microsoft\\\\                                                                                                                                                                                                                                                                                                              |                                                                         |
| Windows\\\\Shell\\\\Bags","UsrClass\.dat\\\\Local Settings\\\\Software\\\\Microsoft\\\\Windows\\\\Shell\\\\BagMRU", "UsrClass\.dat\\\\Local Settings\\\\Software\\\\Microsoft\\\\Windows\\\\Shell\\\\Bags"\]\}, \{"mainkeysid":2,"keys":\["NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\Shell\\\\BagMRU", "NTUSER\.DAT\\\\Software\\\\Microsoft\\\\Windows\\\\Shell\\\\Bags","NTUSER\.DAT\\\\Software\\\\ |                                                                         |
| Microsoft\\\\Windows\\\\ShellNoRoam\\\\BagMRU","NTUSER\.DAT\\\\Software\\\\Microsoft\\\\                                                                                                                                                                                                                                                                                                                        |                                                                         |
| Windows\\\\ShellNoRoam\\\\Bags"\]\}\]\}                                                                                                                                                                                                                                                                                                                                                                         |                                                                         |
| Example of failed response: \{“success”:0, “error”: “No file locations to fetch\.”\}                                                                                                                                                                                                                                                                                                                            |                                                                         |

### _Get Scripts API_

This endpoint is needed to get a list of available Lua scripts. It is located at &quot;/getScripts&quot; at the end of the SeeShells website URL. It is a GET request since this endpoint will be fetching the data in the database without altering it. The scripts are returned as base64 strings, so they need to be decoded to be used.

| Response                                                                                |                                                                |
|-----------------------------------------------------------------------------------------|----------------------------------------------------------------|
| Parameter                                                                               | Description                                                    |
| success                                                                                 | 1 if successful, 0 if not                                      |
| error                                                                                   | If failed, this will contain a message describing the error\.  |
| json                                                                                    | An array with the scripts and their type identifiers\.         |
| Example of successful response: \{"success":1,"json":\[\{"typeidentifier":113,"script": |                                                                |
| "bG9jYWwgZ3VpZCA9IHNoZWxsaXRlbTp1bnBhY2tfZ3VpZCgweDBFKSAKbG9                            |                                                                |
| jYWwgZmxhZyA9IHNoZWxsaXRlbTp1bnBhY2tfYnl0ZSgweDAzKSAKcHJvcGVy                           |                                                                |
| dGllczpBZGQoIlR5cGVOYW1lIiwgIkNvbnRyb2wgUGFuZWwiKSAKcHJvcGVyd                           |                                                                |
| GllczpBZGQoIkd1aWQiLCB0b3N0cmluZyhndWlkKSkgCnByb3BlcnRpZXM6QW                           |                                                                |
| RkKCJGbGFncyIsIHRvc3RyaW5nKGZsYWcpKSAKaWYga25vd25HVUlEczpDb                             |                                                                |
| 250YWluc0tleSh0b3N0cmluZyhndWlkKSkgdGhlbiAKICAgICBwcm9wZXJ0aWV                          |                                                                |
| zOkFkZCgiTmFtZSIsIHN0cmluZy5mb3JtYXQoInt7Q09OVFJPTCBQQU5FTDog                           |                                                                |
| JXN9fSIsIGtub3duR1VJRHNbZ3VpZF0pKSAKZWxzZSAKICAgICBwcm9wZXJ0                            |                                                                |
| aWVzOkFkZCgiTmFtZSIsIHN0cmluZy5mb3JtYXQoInt7Q09OVFJPTCBQQU5FT                           |                                                                |
| DogJXN9fSIsIGd1aWQpKSAKZW5k"\}\]\}                                                      |                                                                |
| Example of failed response: \{“success”: 0, “error”: “Failed to get any scripts”\}      |                                                                |

###_Get Script API_

This endpoint is needed to get a specific Lua scripts. It is located at &quot;/getScript&quot; at the end of the SeeShells website URL. It is a GET request since this endpoint will be fetching the data in the database without altering it. The scripts are returned as base64 strings, so they need to be decoded to be used. The type identifier needs to be included in the request as a query, and the expected responses are in the following figure.

| Response                                                                                        |                                                                         |
|-------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|
| Parameter                                                                                       | Description                                                             |
| success                                                                                         | 1 if successful, 0 if not                                               |
| error                                                                                           | If failed, this will contain a message describing the error\.           |
| script                                                                                          | A base64 representation of the script for the identifier in the query\. |
| Example of successful response: \{"success":1,"script":                                         |                                                                         |
| "bG9jYWwgZ3VpZCA9IHNoZWxsaXRlbTp1bnBhY2tfZ3VpZCgweDBFKSAKbG9                                    |                                                                         |
| jYWwgZmxhZyA9IHNoZWxsaXRlbTp1bnBhY2tfYnl0ZSgweDAzKSAKcHJvcGVy                                   |                                                                         |
| dGllczpBZGQoIlR5cGVOYW1lIiwgIkNvbnRyb2wgUGFuZWwiKSAKcHJvcGVyd                                   |                                                                         |
| GllczpBZGQoIkd1aWQiLCB0b3N0cmluZyhndWlkKSkgCnByb3BlcnRpZXM6QW                                   |                                                                         |
| RkKCJGbGFncyIsIHRvc3RyaW5nKGZsYWcpKSAKaWYga25vd25HVUlEczpDb                                     |                                                                         |
| 250YWluc0tleSh0b3N0cmluZyhndWlkKSkgdGhlbiAKICAgICBwcm9wZXJ0aWV                                  |                                                                         |
| zOkFkZCgiTmFtZSIsIHN0cmluZy5mb3JtYXQoInt7Q09OVFJPTCBQQU5FTDog                                   |                                                                         |
| JXN9fSIsIGtub3duR1VJRHNbZ3VpZF0pKSAKZWxzZSAKICAgICBwcm9wZXJ0                                    |                                                                         |
| aWVzOkFkZCgiTmFtZSIsIHN0cmluZy5mb3JtYXQoInt7Q09OVFJPTCBQQU5FT                                   |                                                                         |
| DogJXN9fSIsIGd1aWQpKSAKZW5k"\}                                                                  |                                                                         |
| Example of failed response: \{“success”: 0, “error”: “No script exists for this identifier\.”\} |                                                                         |

### _Update Script API_

This endpoint is needed to update or add new scripts to the database. Using this endpoint requires a valid session to be active and sent in the header of the request. It is a POST request and is located at &quot;/updateScript&quot; at the end of the SeeShells website URL. For this endpoint, a script must be encoded in base64 or else an error will be returned. If a script already exists for an identifier, the script is replaced with the contents of the request. If a script does not exist for an identifier, a new entry is made in the database for the script. The expected request and response are shown in the following figure.

| Request                                                                        |                                                                |                                                                    |
|--------------------------------------------------------------------------------|----------------------------------------------------------------|--------------------------------------------------------------------|
| Parameter                                                                      | Mandatory                                                      | Description                                                        |
| identifier                                                                     | Yes                                                            | The type identifier of the shell item that the script can parse\.  |
| script                                                                         | Yes                                                            | This is the base64 encoded script for the shell item\.             |
| Example request: \{"identifier": 123, "script":                                |                                                                |                                                                    |
| "bG9jYWwgZ3VpZCA9IHNoZWxsaXRlbTp1bnBhY2tfZ3VpZCgweDBFKSAKb9                    |                                                                |                                                                    |
| jYWwgZmxhZyA9IHNoZWxsaXRlbTp1bnBhY2tfYnl0ZSgweDAzKSAKcHJvcGVy                  |                                                                |                                                                    |
| dGllczpBZGQoIlR5cGVOYW1lIiwgIkNvbnRyb2wgUGFuZWwiKSAKcHJvcGVyd                  |                                                                |                                                                    |
| GllczpBZGQoIkd1aWQiLCB0b3N0cmluZyhndWlkKSkgCnByb3BlcnRpZXM6QW                  |                                                                |                                                                    |
| RkKCJGbGFncyIsIHRvc3RyaW5nKGZsYWcpKSAKaWYga25vd25HVUlEczpDb                    |                                                                |                                                                    |
| 250YWluc0tleSh0b3N0cmluZyhndWlkKSkgdGhlbiAKICAgICBwcm9wZXJ0aWV                 |                                                                |                                                                    |
| zOkFkZCgiTmFtZSIsIHN0cmluZy5mb3JtYXQoInt7Q09OVFJPTCBQQU5FTDog                  |                                                                |                                                                    |
| JXN9fSIsIGtub3duR1VJRHNbZ3VpZF0pKSAKZWxzZSAKICAgICBwcm9wZXJ0                   |                                                                |                                                                    |
| aWVzOkFkZCgiTmFtZSIsIHN0cmluZy5mb3JtYXQoInt7Q09OVFJPTCBQQU5F                   |                                                                |                                                                    |
| DogJXN9fSIsIGd1aWQpKSAKZW5k"\}                                                 |                                                                |                                                                    |
|                                                                                |                                                                |                                                                    |
| Response                                                                       |                                                                |                                                                    |
| Parameter                                                                      | Description                                                    |                                                                    |
| success                                                                        | 1 if successful, 0 if not                                      |                                                                    |
| error                                                                          | If failed, this will contain a message describing the error\.  |                                                                    |
| Example of successful response: \{“success”:1\}                                |                                                                |                                                                    |
| Example of successful response: \{“success”:0, “error”: "Invalid script\." \}  |                                                                |                                                                    |

### _Get Help Information API_

This endpoint is needed to get the information for the Help section on both the website and the WPF. It is a GET request and is located at &quot;/getHelpInformation&quot; at the end of the SeeShells website URL. The response returns a JSON array; with the current implementation, there will only ever be one row of data since the help is simply updated. However, the return of an array allows for a history of help content to be kept if that change is ever implemented in the future. The expected response is shown in the following figure.

| Response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|
| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Description                                                    |
| success                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 1 if successful, 0 if not                                      |
| error                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | If failed, this will contain a message describing the error\.  |
| json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | An array of help information\.                                 |
| Example of successful response: \{"success":1,"json":\[\{"id":1,"title":"SeeShells Documentation and Help","description":"\-\-\-\\n\# SeeShells\\nSeeShells collects ShellBags specific Windows Registry keys and parses through them, and organizes the data found in them to display them on a graphical timeline\.\\\\\\nThe graphical timeline is the unique feature that SeeShells offers over other existing parsers: this timeline makes ShellBag data easier to understand and facilitates the process of finding a significant pattern or piece of evidence\.nSeeShells collects ShellBags specific Windows Registry keys and parses through them, and organizes the data found in them to display them on a graphical timeline\.\\\\\\nThe graphical timeline is the unique feature that SeeShells offers over other existing parsers: this timeline makes ShellBag data easier to understand and facilitates the process of finding a significant pattern or piece of evidence\.\}\]\} |                                                                |
| Example of failed response: \{“success”: 0, “error”: “Failed to get the help information\.”\}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                |

### _Update Help API_

This endpoint is needed to update the Help section on both the website and the WPF. Using this endpoint requires a valid session to be active and sent in the header of the request. It is a POST request and is located at &quot;/changeHelpInformation&quot; at the end of the SeeShells website URL. Help information should be written in markup. The expected request and response are shown in the following figure.

| Request                                                                                               |                                                                |                                |
|-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|--------------------------------|
| Parameter                                                                                             | Mandatory                                                      | Description                    |
| title                                                                                                 | Yes                                                            | The title of the help page\.   |
| description                                                                                           | Yes                                                            | The content of the help page\. |
| Example request: \{"title": "Help Page", "description": “This is the help description now\.” \}       |                                                                |                                |
|                                                                                                       |                                                                |                                |
| Response                                                                                              |                                                                |                                |
| Parameter                                                                                             | Description                                                    |                                |
| success                                                                                               | 1 if successful, 0 if not                                      |                                |
| error                                                                                                 | If failed, this will contain a message describing the error\.  |                                |
| Example of successful response: \{“success”:1\}                                                       |                                                                |                                |
| Example of successful response: \{“success”:0, “error”: "Failed to update the help information\.” \}  |                                                                |                                |

### _Logout API_

This endpoint is needed to allow administrators to logout of the website. It is a GET request and is located at &quot;/logout&quot; at the end of the SeeShells website URL. The session needs to be sent as a header in the request. The expected response is shown in the following figure.

| Response                                                                             |                                                                |
|--------------------------------------------------------------------------------------|----------------------------------------------------------------|
| Parameter                                                                            | Description                                                    |
| success                                                                              | 1 if successful, 0 if not                                      |
| error                                                                                | If failed, this will contain a message describing the error\.  |
| Example of successful response: \{"success": 1 \}                                    |                                                                |
| Example of failed response: \{“success”: 0, “error”: “Failed to destroy session\.”\} |                                                                |
